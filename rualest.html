<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>ูุชุงุฆุฌ ุงูุฑุญูุงุช</title>
  <link rel="stylesheet" href="rualest.css" />
</head>
<body>
  <h2>ูุนูููุงุช ุงูุฑุญูุฉ</h2>
  <div id="tripInfo"></div>

  <h3>ุงูุฑุญูุงุช ุงููุชููุฑุฉ:</h3>
  <div class="er" id="availableTrips"></div>

  <div id="confirmSection" style="display:none; margin-top: 30px; border-top: 2px solid #ccc; padding-top: 15px;">
    <h3>โ ููุฎุต ุงูุญุฌุฒ:</h3>
    <p><b>ุงูุฑุญูุฉ ุงููุฎุชุงุฑุฉ:</b> ูู <span id="selectedFrom"></span> ุฅูู <span id="selectedTo"></span></p>
    <p><b>ููุช ุงูุงูุทูุงู:</b> <span id="selectedDepart"></span></p>
    <p><b>ุงูุณุนุฑ ุงูููู:</b> <span id="selectedTotalPrice"></span> ู.ุณ</p>
    <button id="cancelBtn">โ ุฅูุบุงุก ุงูุงุฎุชูุงุฑ</button>
    <button id="confirmBtn">โ ุชุฃููุฏ ุงูุญุฌุฒ</button>
  </div>

  <script>
    // ุฌูุจ ุจูุงูุงุช ุงูุญุฌุฒ ูู localStorage
    const tripData = JSON.parse(localStorage.getItem("tripData"));

    if (!tripData) {
      document.body.innerHTML = "<p>ูุง ุชูุฌุฏ ุจูุงูุงุช ุญุฌุฒ.</p>";
    } else {
      const { from, to, departureDate, returnDate, tripType, passengers } = tripData;
      const numPassengers = parseInt(passengers);

      // ุนุฑุถ ูุนูููุงุช ุงูุฑุญูุฉ ุงูุฃุณุงุณูุฉ
      document.getElementById("tripInfo").innerHTML = `
        <p><b>ูู:</b> ${from}</p>
        <p><b>ุฅูู:</b> ${to}</p>
        <p><b>ุชุงุฑูุฎ ุงูุฐูุงุจ:</b> ${departureDate}</p>
        ${tripType === "roundtrip" ? `<p><b>ุชุงุฑูุฎ ุงูุนูุฏุฉ:</b> ${returnDate}</p>` : ""}
        <p><b>ุนุฏุฏ ุงููุณุงูุฑูู:</b> ${numPassengers}</p>
        <p><b>ููุน ุงูุฑุญูุฉ:</b> ${tripType === "roundtrip" ? "ุฐูุงุจ ูุนูุฏุฉ" : "ุฐูุงุจ ููุท"}</p>
      `;

      // ุงูุฑุญูุงุช ุงูุชุฌุฑูุจูุฉ ูุน ุงูููุฒุงุช
      const trips = [
        {
          from: "ุงููุงุฐููุฉ",
          to: "ุฏูุดู",
          departTime: "08:00",
          arriveTime: "12:00",
          price: 5000,
          features: [
            { name: "Wi-Fi", icon: "๐ถ" },
            { name: "ุทุนุงู", icon: "๐ฝ๏ธ" },
            { name: "ููุงุนุฏ ูุฑูุญุฉ", icon: "๐บ" }
          ]
        },
        {
          from: "ุงููุงุฐููุฉ",
          to: "ุฏูุดู",
          departTime: "14:00",
          arriveTime: "18:00",
          price: 5500,
          features: [
            { name: "Wi-Fi", icon: "๐ถ" },
            { name: "ูููู", icon: "โ๏ธ" }
          ]
        },
        {
          from: "ุฏูุดู",
          to: "ุญูุจ",
          departTime: "09:00",
          arriveTime: "15:00",
          price: 7000,
          features: [
            { name: "ุทุนุงู", icon: "๐ฝ๏ธ" },
            { name: "ุดุญู USB", icon: "๐" }
          ]
        },
        {
          from: "ุญูุจ",
          to: "ุญูุต",
          departTime: "07:00",
          arriveTime: "09:30",
          price: 3000,
          features: [
            { name: "ููุงุนุฏ ูุฑูุญุฉ", icon: "๐บ" }
          ]
        }
      ];

      // ุชุตููุฉ ุงูุฑุญูุงุช ุจูุงุก ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู
      const matchedTrips = trips.filter(trip => trip.from === from && trip.to === to);

      const tripsDiv = document.getElementById("availableTrips");

      if (matchedTrips.length === 0) {
        tripsDiv.innerHTML = "<p>ูุง ุชูุฌุฏ ุฑุญูุงุช ูุชุงุญุฉ ููุฐู ุงููุฌูุฉ.</p>";
      } else {
        matchedTrips.forEach((trip, index) => {
          // ุญุณุงุจ ุงูุณุนุฑ ุงูููู ุจุญุณุจ ุนุฏุฏ ุงููุณุงูุฑูู
          const totalPrice = trip.price * numPassengers;

          // ุชุญุถูุฑ HTML ููููุฒุงุช ูุน ุฃููููุงุช
          const featuresHtml = trip.features.map(f => 
            `<span title="${f.name}" style="margin-left:6px; font-size:18px;">${f.icon}</span>`
          ).join("");

          tripsDiv.innerHTML += `
            <div class="trip-card" data-index="${index}">
              <p><b>ููุช ุงูุงูุทูุงู:</b> <span class="depart">${trip.departTime}</span></p>
              <p><b>ููุช ุงููุตูู:</b> ${trip.arriveTime}</p>
              <p><b>ุงูุณุนุฑ ููู ุฑุงูุจ:</b> <span class="price">${trip.price}</span> ู.ุณ</p>
              <p><b>ุงูุณุนุฑ ุงูููู (${numPassengers} ูุณุงูุฑูู):</b> <span class="total-price">${totalPrice}</span> ู.ุณ</p>
              <p><b>ุงูููุฒุงุช:</b> ${featuresHtml}</p>
              <button class="select-btn">ุงุฎุชูุงุฑ ูุฐู ุงูุฑุญูุฉ</button>
            </div>
          `;
        });
      }

      // ุฅุถุงูุฉ ุชูุงุนู ุฒุฑ ุงุฎุชูุงุฑ ุงูุฑุญูุฉ
      document.addEventListener("click", function(e) {
        if (e.target.classList.contains("select-btn")) {
          const card = e.target.closest(".trip-card");

          document.getElementById("selectedFrom").textContent = from;
          document.getElementById("selectedTo").textContent = to;
          document.getElementById("selectedDepart").textContent = card.querySelector(".depart").textContent;
          document.getElementById("selectedTotalPrice").textContent = card.querySelector(".total-price").textContent;

          // ุฅุธูุงุฑ ูุณู ุชุฃููุฏ ุงูุญุฌุฒ
          document.getElementById("confirmSection").style.display = "block";

          // ุชุนุทูู ุฌููุน ุฃุฒุฑุงุฑ ุงุฎุชูุงุฑ ุงูุฑุญูุงุช ุงูุฃุฎุฑู
          document.querySelectorAll(".select-btn").forEach(btn => btn.disabled = true);

          // ุฒุฑ ุฅูุบุงุก ุงูุงุฎุชูุงุฑ ูุนูุฏ ูู ุดูุก ููุง ูุงู
          document.getElementById("cancelBtn").onclick = () => {
            document.getElementById("confirmSection").style.display = "none";
            document.querySelectorAll(".select-btn").forEach(btn => btn.disabled = false);
          };

          // ุฒุฑ ุชุฃููุฏ ุงูุญุฌุฒ
          document.getElementById("confirmBtn").onclick = () => {
            alert("โ ุชู ุชุฃููุฏ ุงูุญุฌุฒ (ุณูุชู ุฑุจุทู ูุงุญูุงู ูุน ุงูุจุงู ุฅูุฏ).");
          };
        }
      });
    }
  </script>
</body>
</html>
